<!DOCTYPE html>
<!-- THIS WEBSITE IS BUILT BY LOKABRENNA -->
<!--
⠀  ⠀   (\__/)
       (•ㅅ•)      
    ＿ノヽ ノ＼＿      
`/　`/ ⌒Ｙ⌒ Ｙ  ヽ     
( 　(三ヽ人　 /　  |
|　ﾉ⌒＼ ￣￣ヽ   ノ    
ヽ＿＿＿＞､＿＿_／
    ｜( 王 ﾉ〈   
   /ﾐ`ー―ー 彡\       
-->
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trộn gỏi bọn reup</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tahoma:wght@700&family=Georgia:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
    body {
        background-color: #e6f3e6;
        font-family: 'Tahoma', sans-serif;
        margin: 0;
        padding: 35px;
        box-sizing: border-box;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .title {
        font-family: 'Georgia', serif;
        font-size: 40px;
        color: #044a42;
        text-transform: uppercase;
        margin-bottom: 10px;
        text-align: center;
    }

    h1,
    h2 {
        font-size: 24px;
        color: #044a42;
        text-transform: uppercase;
        font-weight: 700;
        margin-bottom: 10px;
    }

    .subheaders {
        width: 100%;
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        text-align: center;
    }

    .subheader {
        width: 48%;
        position: relative;
    }

    .textareas {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
        gap: 20px;
    }

    textarea,
    #outputHtml {
        width: calc(100% - 10px);
        height: 300px;
        padding: 20px;
        border: 4px solid #044a42;
        border-radius: 10px;
        resize: none;
        font-size: 14px;
        color: #333;
        background-color: #fff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        box-sizing: border-box;
        overflow-y: scroll;
    }

    textarea:focus {
        outline: none;
        border-color: #044a42;
        box-shadow: 0 0 10px rgba(3, 111, 91, 0.2);
    }

    #copyButton {
        font-family: 'Tahoma', sans-serif;
        position: absolute;
        top: -10px;
        right: -10px;
        transform: translate(0, 50%);
        background-color: #044a42;
        color: #fff;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 5px;
        font-size: 12px;
        z-index: 1;
    }

    #copyButton:hover {
        background-color: #036f5b;
    }

    .shuffle-button {
        display: block;
        margin: 0 auto;
        background-color: #044a42;
        color: #fff;
        font-family: 'Tahoma', sans-serif;
        font-size: 20px;
        text-transform: uppercase;
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 100px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        min-width: 150px;
        text-align: center;
    }

    .shuffle-button:hover {
        background-color: #036f5b;
    }

    .watermark {
        margin-top: 25px;
        text-align: center;
        color: #044a42;
        font-family: 'Tahoma', sans-serif;
        font-size: 14px;
    }

    .watermark a {
        text-decoration: none;
        color: #044a42;
    }
    
    .social-icons {
        margin-top: 10px;
        text-align: center;
    }

    .icon {
        margin: 0 5px;
        color: #044a42;
        font-size: 14px;
        text-decoration: none;
    }

    .icon:hover {
        color: #036f5b;
    }

    @media (max-width: 768px) {
        .subheaders,
        .textareas {
            flex-direction: column;
            align-items: center;
        }

        textarea,
        #outputHtml {
            width: 100%;
            margin-bottom: 10px;
        }
    }
</style>

</head>
<body>
    <div class="container">
      <div class="title"><b>BÁNH TRÁNG TRỘN</b></div>
        
        <div class="subheaders">
            <div class="subheader">
                <h1>Cho nguyên liệu</h1>
                <textarea id="inputText" placeholder="Dán nội dung gốc vào đây..."></textarea>
            </div>
            <div class="subheader">
                <h2>Măm măm nào</h2>
                <textarea id="outputHtml" placeholder="Nhấn copy để sao chép toàn bộ..." readonly></textarea>
                <button id="copyButton" onclick="copyToClipboard()" style="position: absolute; right: 10px; top: 10px;">Copy</button>
            </div>
        </div>
        
        <div>
            <button class="shuffle-button" onclick="shuffleContent()"><b>TRỘN</b></button>
        </div>
        <div class="watermark">    
                <b>By Lokabrenna</b>
            
            <div class="social-icons">
                <a href="https://www.facebook.com/iamlokabrenna/" target="_blank" class="icon"><i class="fab fa-facebook-f"></i></a>
                <a href="https://iamlokabrenna.wordpress.com" target="_blank" class="icon"><i class="fab fa-wordpress"></i></a>
                <a href="https://www.wattpad.com/user/iamlokabrenna" target="_blank" class="icon">
                    <img src="https://iamlokabrenna.wordpress.com/wp-content/uploads/2024/08/wattpad-1.png" alt="Wattpad" style="width: 14px; height: 14px;"></a>
            </div>
        </div>
    </div>
    
    <script>
    function copyToClipboard() {
    var copyText = document.getElementById("outputHtml");
    copyText.select();
    document.execCommand("copy");
        
    var copyButton = document.getElementById("copyButton");
    copyButton.innerText = "Copied!";

    setTimeout(function() {
        copyButton.innerText = "Copy";
    }, 3000);
}

    function shuffleContent() {
        const inputText = document.getElementById('inputText').value.trim();

        if (!inputText) {
            alert('Vui lòng nhập nội dung gốc.');
            return;
        }

        const parser = new DOMParser();
        const doc = parser.parseFromString(inputText, 'text/html');

        const paragraphs = doc.querySelectorAll('p');

        if (paragraphs.length === 0) {
            alert('Không tìm thấy thẻ <p> nào để xáo trộn.');
            return;
        }

        const allSentences = [];

        paragraphs.forEach(p => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = p.innerHTML;

            const textNodes = [];
            const traverseNodes = (node) => {
                if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
                    textNodes.push(node);
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    node.childNodes.forEach(traverseNodes);
                }
            };
            traverseNodes(tempDiv);

            const textContents = textNodes.map(node => node.textContent.trim()).filter(text => text.length > 0);
            const sentences = textContents.join(' ').match(/[^.!?]+[.!?]*\s*/g) || [];

            allSentences.push(...sentences);
        });

        const shuffledSentences = [...allSentences];
        for (let i = shuffledSentences.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffledSentences[i], shuffledSentences[j]] = [shuffledSentences[j], shuffledSentences[i]];
        }

        let shuffledIndex = 0;
        paragraphs.forEach(p => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = p.innerHTML;

            const textNodes = [];
            const traverseNodes = (node) => {
                if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
                    textNodes.push(node);
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    node.childNodes.forEach(traverseNodes);
                }
            };
            traverseNodes(tempDiv);

            let resultHtml = p.innerHTML;
            textNodes.forEach((node, index) => {
                if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
                    const originalSentence = node.textContent;
                    const hiddenSentence = shuffledSentences[shuffledIndex] || '';
                    shuffledIndex++;
                    resultHtml = resultHtml.replace(
                        originalSentence,
                        `${originalSentence}<span style="position: absolute; left: -9999px; top: -9999px;">&#8203;${hiddenSentence}</span>`
                    );
                }
            });

            p.innerHTML = resultHtml;
        });

        const serializer = new XMLSerializer();
        const resultHtml = serializer.serializeToString(doc.body);
        document.getElementById('outputHtml').value = resultHtml.trim();
    }
    </script>
</body>
</html>
